<!-- 保留已有功能 -->
<!-- 添加分页控制区域 -->
<div id="pagination-controls" style="margin-top: 1em; display: none; text-align: center;">
  <button onclick="prevPage()">上一页</button>
  <span id="page-info"></span>
  <button onclick="nextPage()">下一页</button>
  <br><br>
  每页显示：
  <select id="perPageSelect" onchange="updatePerPage()">
    <option value="5">5</option>
    <option value="10" selected>10</option>
    <option value="20">20</option>
  </select>
</div>

<!-- 单词列表容器 -->
<div id="word-list"></div>

<script>
let allWords = [];
let currentPage = 1;
let perPage = 10;

function updatePerPage() {
  perPage = parseInt(document.getElementById("perPageSelect").value);
  currentPage = 1;
  renderPagedWords();
}

function prevPage() {
  if (currentPage > 1) {
    currentPage--;
    renderPagedWords();
  }
}

function nextPage() {
  const totalPages = Math.ceil(allWords.length / perPage);
  if (currentPage < totalPages) {
    currentPage++;
    renderPagedWords();
  }
}

function renderPagedWords() {
  const list = document.getElementById("word-list");
  list.innerHTML = "";
  const start = (currentPage - 1) * perPage;
  const pageWords = allWords.slice(start, start + perPage);
  pageWords.forEach(({ docSnap, w }) => {
    const div = document.createElement("div");
    div.className = "card";
    div.innerHTML = `
      <div style='display:flex;justify-content:space-between;'>
        <b>${w.text}</b>
        <button onclick="document.getElementById('a-${docSnap.id}').play()">🔊</button>
        <audio id="a-${docSnap.id}" src="${w.audio}"></audio>
      </div>
      <div style='color:gray;'>${w.phonetic || ''}</div>
      <div>释义：${w.meaning}</div>
      <button onclick="deleteWord('${docSnap.id}')">删除</button>
    `;
    list.appendChild(div);
  });
  const totalPages = Math.ceil(allWords.length / perPage);
  document.getElementById("page-info").innerText = `第 ${currentPage} 页 / 共 ${totalPages} 页`;
  document.getElementById("pagination-controls").style.display = allWords.length > perPage ? "block" : "none";
}
</script>
